# Задача  

Заказчик DonorSearch - занимается развитием донорства в стране. Для этого есть платформа DonorSearch.org - где для доноров доступны бонусная программа, игрофикация пути донора и многое другое. Важной является проверка честности доноров и корректности внесенных донаций. Подтверждение производится по справке установленной формы (№405), такую справку донор получает в центре крови. Далее загружает как картинку или pdf в личный кабинет. Раньше операторами платформы все донации верифицировались вручную. В 2023 году был разработан сервис OCR (optical character recognition) для распознавания табличной информации на бланке справки и записи результатов в .csv файл. Существующая версия сервиса требует вертикальной ориентации справки, однако с точки зрения удобства пользователя хотелось бы обрабатывать справки независимо от их ориентации. Именно эту задачу нужно решить: разработать модель определения ориентации справки и автоматического поворота ее в нормальное положение перед запуском сервиса OCR.

 - Исследование существующих подходов к решению задачи.
 - Выбор готовой или обучение собственной модели компьютерного зрения для определения ориентации изображения.
 - Тестирование модели, определение метрик.
 - Подготовка скриптов для препроцессинга изображения, инференса модели и постпроцессинга изображения.
 - Создание микросервиса для последующей интеграции в продукт заказчика.

**Данные**  

Датасет состоит из нескольких сотен изображений справок формы 405 и не только. Дальнейшая подготовка датасета осуществляется исполнителем проекта.

**Метрика**  
Для оценки качества должны быть как минимум:

    - Рассчитана Accuracy для многоклассовой классификации;
    - Построены ROC-кривые и матрицы ошибок для наилучшей из моделей.

**Технические требования**

Формат входных данных - путь к изображению;  
Формат выходных данных - np.array или Pillow.Image;  
Количество классов классификатора - 4 (поворот на 0, 90, 180 или 270 градусов);  
Инференс - на CPU.

**План работ**  

    1. Увеличить количество справок для обучения модели в 4 раза с помощью поворота каждой справки в 4 положения: 0, 90, 180 и 270 градусов.  
    2. Изучить данные, посмотреть на изображения справок.  
    3. Извлечь эмбеддинги и построить baseline модель. Будем классифицировать справки по 4 классам:  

      (0) - справки повернутые на 0 градусов,  
      (1) - справки повернутые на 90 градусов,  
      (2) - справки повернутые на 180 градусов,  
      (3) - справки повернутые на 270 градусов.  

В качестве baseline возьмем модель LogisticRegression.  

    - Построить модель определения ориентации справки с помощью сверточной нейросети. За основу возьмем предобученую модель ResNet50.  
    - Применить модель для классификации тестового изображения. И применить автоматический поворот в 0 градусов.



# Сборка и запуск docker-образа  

- Клонировать репозиторий  
- Собрать докер образ  
```cmd
docker build --tag dscr .
```
- Запустить контейнер
```cmd
docker run --rm -it -p 8010:8000 --name app dscr
```
    
